# éŒ¯èª¤æ’æŸ¥èˆ‡æ”¯æ´

æœ¬æ–‡ä»¶æä¾›å¸¸è¦‹å•é¡Œçš„æ’æŸ¥æ­¥é©Ÿèˆ‡è§£æ±ºæ–¹æ¡ˆã€‚

---

## ç›®éŒ„

- [å¸¸è¦‹å•é¡Œé€ŸæŸ¥](#å¸¸è¦‹å•é¡Œé€ŸæŸ¥)
- [ç™»å…¥èˆ‡èªè­‰å•é¡Œ](#ç™»å…¥èˆ‡èªè­‰å•é¡Œ)
- [è½‰æ›ç›¸é—œå•é¡Œ](#è½‰æ›ç›¸é—œå•é¡Œ)
- [Docker ç›¸é—œå•é¡Œ](#docker-ç›¸é—œå•é¡Œ)
- [æ•ˆèƒ½å•é¡Œ](#æ•ˆèƒ½å•é¡Œ)
- [æ—¥èªŒæ”¶é›†èˆ‡åˆ†æ](#æ—¥èªŒæ”¶é›†èˆ‡åˆ†æ)
- [å–å¾—æ”¯æ´](#å–å¾—æ”¯æ´)

---

## å¸¸è¦‹å•é¡Œé€ŸæŸ¥

| å•é¡Œ               | å¯èƒ½åŸå›                | å¿«é€Ÿè§£æ±º                                       |
| ------------------ | ---------------------- | ---------------------------------------------- |
| ç™»å…¥å¾Œè¢«è¸¢å›ç™»å…¥é  | HTTP/HTTPS è¨­å®šä¸æ­£ç¢º  | åŠ ä¸Š `HTTP_ALLOWED=true` æˆ– `TRUST_PROXY=true` |
| é‡å•Ÿå¾Œè³‡æ–™æ¶ˆå¤±     | Volume æœªæ­£ç¢ºæ›è¼‰      | ç¢ºèª `./data:/app/data` ä¸”è³‡æ–™å¤¾å­˜åœ¨           |
| é‡å•Ÿå¾Œè¢«ç™»å‡º       | JWT_SECRET æœªå›ºå®š      | è¨­å®šå›ºå®šçš„ `JWT_SECRET`                        |
| ä¸­æ–‡é¡¯ç¤ºäº‚ç¢¼       | ä½¿ç”¨ Lite ç‰ˆï¼ˆç„¡å­—å‹ï¼‰ | æ”¹ç”¨ä¸€èˆ¬ç‰ˆæˆ– Full ç‰ˆ                           |
| è½‰æ›å¤±æ•—           | æ ¼å¼ä¸æ”¯æ´æˆ–æª”æ¡ˆæå£   | æª¢æŸ¥æ”¯æ´æ ¼å¼åˆ—è¡¨ï¼Œç¢ºèªæª”æ¡ˆå®Œæ•´                 |
| å®¹å™¨å•Ÿå‹•å¤±æ•—       | ç«¯å£è¡çªæˆ–è¨˜æ†¶é«”ä¸è¶³   | æª¢æŸ¥ç«¯å£ä½¿ç”¨ï¼Œå¢åŠ è¨˜æ†¶é«”                       |

---

## ç™»å…¥èˆ‡èªè­‰å•é¡Œ

### å•é¡Œï¼šç™»å…¥å¾Œåˆè¢«å°å›ç™»å…¥é 

**ç—‡ç‹€**ï¼š

- è¼¸å…¥å¸³å¯†å¾Œé é¢é–ƒä¸€ä¸‹åˆå›åˆ°ç™»å…¥é 
- Cookie ç„¡æ³•æ­£ç¢ºè¨­å®š

**åŸå› èˆ‡è§£æ±º**ï¼š

1. **ä½¿ç”¨ HTTP ä½†æœªå…è¨±**

   ```yaml
   environment:
     - HTTP_ALLOWED=true # å…è¨± HTTP é€£ç·š
   ```

2. **ä½¿ç”¨åå‘ä»£ç†ä½†æœªè¨­å®šä¿¡ä»»**

   ```yaml
   environment:
     - TRUST_PROXY=true # ä¿¡ä»»åå‘ä»£ç†
   ```

3. **åå‘ä»£ç†æœªæ­£ç¢ºå‚³é headers**

   Nginx è¨­å®šéœ€åŒ…å«ï¼š

   ```nginx
   proxy_set_header X-Forwarded-Proto $scheme;
   proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
   ```

### å•é¡Œï¼šé‡å•Ÿå®¹å™¨å¾Œéœ€è¦é‡æ–°ç™»å…¥

**ç—‡ç‹€**ï¼š

- æ¯æ¬¡é‡å•Ÿå®¹å™¨å¾Œæ‰€æœ‰ä½¿ç”¨è€…éƒ½éœ€è¦é‡æ–°ç™»å…¥

**åŸå› **ï¼šJWT_SECRET æœªå›ºå®šï¼Œæ¯æ¬¡å•Ÿå‹•æœƒç”¢ç”Ÿæ–°çš„éš¨æ©Ÿå¯†é‘°ã€‚

**è§£æ±º**ï¼š

```yaml
environment:
  - JWT_SECRET=æ‚¨çš„å›ºå®šéš¨æ©Ÿå¯†é‘°è‡³å°‘32å­—å…ƒ
```

ç”¢ç”Ÿå¯†é‘°ï¼š

```bash
openssl rand -hex 32
```

### å•é¡Œï¼šç„¡æ³•è¨»å†Šæ–°å¸³è™Ÿ

**ç—‡ç‹€**ï¼š

- æ‰¾ä¸åˆ°è¨»å†ŠæŒ‰éˆ•
- è¨»å†Šæ™‚é¡¯ç¤ºéŒ¯èª¤

**åŸå› **ï¼šè¨»å†ŠåŠŸèƒ½è¢«é—œé–‰

**è§£æ±º**ï¼š

```yaml
environment:
  - ACCOUNT_REGISTRATION=true
```

---

## è½‰æ›ç›¸é—œå•é¡Œ

### å•é¡Œï¼šè½‰æ›å¤±æ•—ï¼Œé¡¯ç¤ºã€Œæ ¼å¼ä¸æ”¯æ´ã€

**æ’æŸ¥æ­¥é©Ÿ**ï¼š

1. **ç¢ºèªæ ¼å¼æ”¯æ´**
   - æŸ¥çœ‹ [04-åŠŸèƒ½ç¸½è¦½](04-åŠŸèƒ½ç¸½è¦½.md) çš„æ ¼å¼åˆ—è¡¨
   - ç¢ºèªè¼¸å…¥å’Œè¼¸å‡ºæ ¼å¼éƒ½æœ‰æ”¯æ´

2. **ç¢ºèªç‰ˆæœ¬**
   - Lite ç‰ˆåŠŸèƒ½è¼ƒå°‘ï¼ŒæŸäº›æ ¼å¼å¯èƒ½ä¸æ”¯æ´
   - æ”¹ç”¨ä¸€èˆ¬ç‰ˆæˆ– Full ç‰ˆ

3. **æª¢æŸ¥æª”æ¡ˆ**
   - ç¢ºèªæª”æ¡ˆæœªæå£
   - å˜—è©¦ç”¨å…¶ä»–è»Ÿé«”é–‹å•Ÿç¢ºèª

### å•é¡Œï¼šä¸­æ–‡æ–‡ä»¶è½‰æ›å¾Œå‡ºç¾äº‚ç¢¼

**åŸå› **ï¼šç¼ºå°‘ä¸­æ–‡å­—å‹

**è§£æ±º**ï¼š

1. **ä½¿ç”¨ä¸€èˆ¬ç‰ˆæˆ– Full ç‰ˆ**ï¼ˆå·²å…§å»º CJK å­—å‹ï¼‰

2. **Lite ç‰ˆæ‰‹å‹•æ›è¼‰å­—å‹**ï¼š
   ```yaml
   volumes:
     - ./fonts:/usr/share/fonts/custom
   ```

### å•é¡Œï¼šPDF ç¿»è­¯åŠŸèƒ½ç„¡æ³•ä½¿ç”¨

**æ’æŸ¥æ­¥é©Ÿ**ï¼š

1. **ç¢ºèªç‰ˆæœ¬**ï¼šLite ç‰ˆä¸æ”¯æ´ PDF ç¿»è­¯

2. **ç¢ºèªè¨­å®š**ï¼š

   ```yaml
   environment:
     - PDFMATHTRANSLATE_SERVICE=google
   ```

3. **æª¢æŸ¥ç¶²è·¯**ï¼šç¿»è­¯åŠŸèƒ½éœ€è¦ç¶²è·¯é€£ç·š

### å•é¡Œï¼šè½‰æ›æ™‚é–“éé•·

**å¯èƒ½åŸå› **ï¼š

1. æª”æ¡ˆå¤ªå¤§
2. ç³»çµ±è³‡æºä¸è¶³
3. åŒæ™‚è½‰æ›ä»»å‹™éå¤š

**è§£æ±ºæ–¹æ¡ˆ**ï¼š

1. **é™åˆ¶åŒæ™‚è½‰æ›æ•¸**ï¼š

   ```yaml
   environment:
     - MAX_CONVERT_PROCESS=4
   ```

2. **å¢åŠ è³‡æºé™åˆ¶**ï¼š

   ```yaml
   deploy:
     resources:
       limits:
         cpus: "4"
         memory: 8G
   ```

3. **å•Ÿç”¨ GPU åŠ é€Ÿ**ï¼ˆFFmpegï¼‰ï¼š
   ```yaml
   environment:
     - FFMPEG_ARGS=-hwaccel cuda
     - FFMPEG_OUTPUT_ARGS=-c:v h264_nvenc
   ```

---

## Docker ç›¸é—œå•é¡Œ

### å•é¡Œï¼šå®¹å™¨ç„¡æ³•å•Ÿå‹•

**æ’æŸ¥æ­¥é©Ÿ**ï¼š

1. **æª¢æŸ¥æ—¥èªŒ**ï¼š

   ```bash
   docker logs convertx-cn
   ```

2. **æª¢æŸ¥ç«¯å£ä½”ç”¨**ï¼š

   ```bash
   # Linux / macOS
   lsof -i :3000

   # Windows
   netstat -ano | findstr :3000
   ```

3. **æª¢æŸ¥ç£ç¢Ÿç©ºé–“**ï¼š

   ```bash
   docker system df
   ```

4. **æª¢æŸ¥è¨˜æ†¶é«”**ï¼š
   ```bash
   docker stats
   ```

### å•é¡Œï¼šè³‡æ–™åœ¨é‡å•Ÿå¾Œæ¶ˆå¤±

**åŸå› **ï¼šVolume æœªæ­£ç¢ºæ›è¼‰

**ç¢ºèªæ–¹å¼**ï¼š

```bash
docker inspect convertx-cn | grep -A 10 Mounts
```

**æ­£ç¢ºè¨­å®š**ï¼š

```yaml
volumes:
  - ./data:/app/data
```

ç¢ºä¿æœ¬æ©Ÿçš„ `./data` è³‡æ–™å¤¾å­˜åœ¨ï¼š

```bash
mkdir -p ./data
```

### å•é¡Œï¼šæ‹‰å– Image å¤±æ•—

**è§£æ±ºæ–¹æ¡ˆ**ï¼š

1. **æª¢æŸ¥ç¶²è·¯é€£ç·š**

2. **ä½¿ç”¨é¡åƒç«™**ï¼ˆä¸­åœ‹å¤§é™¸ï¼‰ï¼š

   ```bash
   docker pull registry.cn-hangzhou.aliyuncs.com/convertx/convertx-cn:latest
   ```

3. **æ‰‹å‹•ä¸‹è¼‰**ï¼š
   å¾ GitHub Releases ä¸‹è¼‰ Image tarball

### å•é¡Œï¼šç£ç¢Ÿç©ºé–“ä¸è¶³

**æ¸…ç†æ–¹å¼**ï¼š

```bash
# æ¸…ç†æœªä½¿ç”¨çš„è³‡æº
docker system prune -a

# æ¸…ç†èˆŠçš„è½‰æ›æª”æ¡ˆ
rm -rf ./data/output/*
rm -rf ./data/uploads/*
```

**é é˜²æªæ–½**ï¼š

```yaml
environment:
  - AUTO_DELETE_EVERY_N_HOURS=6 # é »ç¹æ¸…ç†
```

---

## æ•ˆèƒ½å•é¡Œ

### è¨ºæ–·æ•ˆèƒ½å•é¡Œ

1. **æŸ¥çœ‹ç³»çµ±è³‡æºä½¿ç”¨**ï¼š

   ```bash
   docker stats convertx-cn
   ```

2. **æŸ¥çœ‹å®¹å™¨å…§éƒ¨ç‹€æ…‹**ï¼š
   ```bash
   docker exec -it convertx-cn top
   ```

### æ•ˆèƒ½å„ªåŒ–å»ºè­°

| å•é¡Œ         | è§£æ±ºæ–¹æ¡ˆ                   |
| ------------ | -------------------------- |
| CPU ä½¿ç”¨ç‡é«˜ | é™åˆ¶ `MAX_CONVERT_PROCESS` |
| è¨˜æ†¶é«”ä¸è¶³   | å¢åŠ å®¹å™¨è¨˜æ†¶é«”é™åˆ¶         |
| ç£ç¢Ÿ I/O æ…¢  | ä½¿ç”¨ SSDï¼Œå¢åŠ  Volume æ•ˆèƒ½ |
| ç¶²è·¯å»¶é²     | ä½¿ç”¨æœ¬åœ°éƒ¨ç½²               |

### æ¨è–¦ç¡¬é«”é…ç½®

| ç”¨é€”     | CPU  | è¨˜æ†¶é«” | ç£ç¢Ÿ       |
| -------- | ---- | ------ | ---------- |
| å€‹äººä½¿ç”¨ | 2 æ ¸ | 4 GB   | 20 GB      |
| å°åœ˜éšŠ   | 4 æ ¸ | 8 GB   | 50 GB      |
| ç”Ÿç”¢ç’°å¢ƒ | 8 æ ¸ | 16 GB  | 100 GB SSD |

---

## æ—¥èªŒæ”¶é›†èˆ‡åˆ†æ

### æŸ¥çœ‹æ—¥èªŒ

```bash
# å³æ™‚æ—¥èªŒ
docker logs -f convertx-cn

# æœ€è¿‘ 100 è¡Œ
docker logs --tail 100 convertx-cn

# æŒ‡å®šæ™‚é–“ç¯„åœ
docker logs --since "2026-01-25T00:00:00" convertx-cn
```

### æ—¥èªŒç­‰ç´š

| ç­‰ç´š    | èªªæ˜             |
| ------- | ---------------- |
| `ERROR` | éŒ¯èª¤ï¼Œéœ€è¦è™•ç†   |
| `WARN`  | è­¦å‘Šï¼Œå¯èƒ½æœ‰å•é¡Œ |
| `INFO`  | ä¸€èˆ¬è³‡è¨Š         |
| `DEBUG` | é™¤éŒ¯è³‡è¨Š         |

### å¸¸è¦‹æ—¥èªŒè¨Šæ¯

| è¨Šæ¯                         | èªªæ˜         |
| ---------------------------- | ------------ |
| `ğŸ¦Š Elysia is running at...` | æœå‹™æ­£å¸¸å•Ÿå‹• |
| `Conversion started...`      | é–‹å§‹è½‰æ›     |
| `Conversion completed...`    | è½‰æ›å®Œæˆ     |
| `Error: ENOSPC...`           | ç£ç¢Ÿç©ºé–“ä¸è¶³ |
| `Error: ENOMEM...`           | è¨˜æ†¶é«”ä¸è¶³   |

### åŒ¯å‡ºæ—¥èªŒ

```bash
# åŒ¯å‡ºåˆ°æª”æ¡ˆ
docker logs convertx-cn > convertx-logs.txt 2>&1

# å£“ç¸®åŒ¯å‡º
docker logs convertx-cn 2>&1 | gzip > convertx-logs.gz
```

---

## å–å¾—æ”¯æ´

### è‡ªåŠ©è³‡æº

1. **æŸ¥é–±æ–‡ä»¶**ï¼šå…ˆæŸ¥çœ‹æœ¬å°ˆæ¡ˆæ–‡ä»¶
2. **æœå°‹ Issues**ï¼š[GitHub Issues](https://github.com/pi-docket/ConvertX-CN/issues)
3. **ç¤¾ç¾¤è¨è«–**ï¼š[GitHub Discussions](https://github.com/pi-docket/ConvertX-CN/discussions)

### æäº¤å•é¡Œ

æäº¤ Issue æ™‚è«‹åŒ…å«ï¼š

1. **ç’°å¢ƒè³‡è¨Š**ï¼š
   - Docker ç‰ˆæœ¬
   - ConvertX-CN ç‰ˆæœ¬ï¼ˆImage Tagï¼‰
   - ä½œæ¥­ç³»çµ±

2. **å•é¡Œæè¿°**ï¼š
   - é æœŸè¡Œç‚º
   - å¯¦éš›è¡Œç‚º
   - é‡ç¾æ­¥é©Ÿ

3. **ç›¸é—œè³‡è¨Š**ï¼š
   - ç’°å¢ƒè®Šæ•¸è¨­å®šï¼ˆéš±è—æ•æ„Ÿè³‡è¨Šï¼‰
   - ç›¸é—œæ—¥èªŒ
   - è¢å¹•æˆªåœ–ï¼ˆå¦‚é©ç”¨ï¼‰

### Issue ç¯„æœ¬

````markdown
## ç’°å¢ƒ

- ConvertX-CN ç‰ˆæœ¬ï¼š`latest`
- Docker ç‰ˆæœ¬ï¼š`24.0.5`
- ä½œæ¥­ç³»çµ±ï¼šUbuntu 22.04

## å•é¡Œæè¿°

ç™»å…¥å¾Œè¢«è¸¢å›ç™»å…¥é ã€‚

## é‡ç¾æ­¥é©Ÿ

1. è¨ªå• http://localhost:3000
2. è¼¸å…¥å¸³è™Ÿå¯†ç¢¼
3. é»æ“Šç™»å…¥
4. é é¢é–ƒä¸€ä¸‹å¾Œå›åˆ°ç™»å…¥é 

## ç’°å¢ƒè®Šæ•¸

```yaml
environment:
  - TZ=Asia/Taipei
  - JWT_SECRET=****
```
````

## æ—¥èªŒ

```
[ç›¸é—œæ—¥èªŒå…§å®¹]
```

```

### è¯ç¹«æ–¹å¼

| ç®¡é“ | é€£çµ |
|------|------|
| GitHub Issues | [å»ºç«‹ Issue](https://github.com/pi-docket/ConvertX-CN/issues) |
| GitHub Discussions | [ç¤¾ç¾¤è¨è«–](https://github.com/pi-docket/ConvertX-CN/discussions) |

---

[â¬†ï¸ å›åˆ°é ‚éƒ¨](#éŒ¯èª¤æ’æŸ¥èˆ‡æ”¯æ´) | [ğŸ“š å›åˆ°ç›®éŒ„](00-å°ˆæ¡ˆç¸½è¦½.md)
```
