# API ç¸½è¦½

ConvertX-CN æä¾›é¸ç”¨çš„ API Serverï¼Œæ”¯æ´ REST å’Œ GraphQL å…©ç¨® API ä»‹é¢ã€‚

---

## åŠŸèƒ½ç‰¹è‰²

- ğŸ” **JWT èªè­‰**ï¼šå®‰å…¨çš„ API å­˜å–æ§åˆ¶
- ğŸŒ **REST + GraphQL**ï¼šé›™å”è­°æ”¯æ´
- ğŸ” **æ™ºæ…§å»ºè­°**ï¼šè½‰æ›å¤±æ•—æ™‚æ¨è–¦æ›¿ä»£å¼•æ“
- ğŸ› ï¸ **20+ è½‰æ›å¼•æ“**ï¼šèˆ‡ Web UI å…±ç”¨å®Œæ•´è½‰æ›å™¨

---

## å¿«é€Ÿå•Ÿç”¨

API Server æ˜¯**é¸ç”¨åŠŸèƒ½**ï¼Œä¸å½±éŸ¿ Web UI ä½¿ç”¨ã€‚

### å•Ÿç”¨æ–¹å¼

```bash
docker compose --profile api up -d
```

### æœå‹™ç«¯å£

| æœå‹™       | ç«¯å£ | èªªæ˜           |
| ---------- | ---- | -------------- |
| Web UI     | 3000 | ç¶²é ä»‹é¢       |
| API Server | 3001 | REST & GraphQL |

---

## API ç«¯é»

### REST API

- **Base URL**: `http://localhost:3001/api/v1`
- **Content-Type**: `application/json` æˆ– `multipart/form-data`

### GraphQL API

- **Endpoint**: `http://localhost:3001/graphql`
- **Playground**: `http://localhost:3001/graphql`ï¼ˆé–‹ç™¼æ¨¡å¼ï¼‰

---

## èªè­‰

æ‰€æœ‰ API è«‹æ±‚ï¼ˆé™¤å¥åº·æª¢æŸ¥å¤–ï¼‰éƒ½éœ€è¦ JWT Bearer Tokenï¼š

```http
Authorization: Bearer <your-jwt-token>
```

### Token çµæ§‹

```json
{
  "sub": "user-id",
  "exp": 1234567890,
  "iat": 1234567890,
  "email": "user@example.com",
  "roles": ["user"]
}
```

> API Server åªè² è²¬é©—è­‰ JWTï¼Œä¸è² è²¬ç”¢ç”Ÿ JWTã€‚Token æ‡‰ç”±ç¨ç«‹çš„èªè­‰æœå‹™ç”¢ç”Ÿã€‚

---

## ç’°å¢ƒè®Šæ•¸

| è®Šæ•¸            | èªªæ˜         | é è¨­å€¼           |
| --------------- | ------------ | ---------------- |
| `API_HOST`      | ç›£è½åœ°å€     | `0.0.0.0`        |
| `API_PORT`      | ç›£è½åŸ        | `3001`           |
| `JWT_SECRET`    | JWT é©—è­‰å¯†é‘° | ï¼ˆéœ€è‡ªè¡Œè¨­å®šï¼‰   |
| `UPLOAD_DIR`    | ä¸Šå‚³ç›®éŒ„     | `./data/uploads` |
| `OUTPUT_DIR`    | è¼¸å‡ºç›®éŒ„     | `./data/output`  |
| `MAX_FILE_SIZE` | æœ€å¤§æª”æ¡ˆå¤§å° | `104857600`      |

---

## å¿«é€Ÿç¯„ä¾‹

### å¥åº·æª¢æŸ¥

```bash
curl http://localhost:3001/health
```

å›æ‡‰ï¼š

```json
{
  "status": "healthy",
  "version": "0.1.0",
  "timestamp": "2026-01-23T10:30:00Z"
}
```

### åˆ—å‡ºå¼•æ“

```bash
curl -H "Authorization: Bearer <token>" \
  http://localhost:3001/api/v1/engines
```

### è½‰æ›æª”æ¡ˆ

```bash
curl -X POST \
  -H "Authorization: Bearer <token>" \
  -F "file=@document.docx" \
  -F "engine=libreoffice" \
  -F "output_format=pdf" \
  http://localhost:3001/api/v1/convert
```

---

## ç›¸é—œæ–‡ä»¶

- [API ç«¯é»è©³ç´°èªªæ˜](ç«¯é».md)
- [API è¦æ ¼æ–‡ä»¶](../../api-server/docs/API_SPEC.md)
- [æ¶æ§‹èªªæ˜](../../api-server/docs/ARCHITECTURE.md)
